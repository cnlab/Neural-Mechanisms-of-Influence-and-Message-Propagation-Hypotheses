---
author: '@darpa_study_team'
date: "10/12/2017"
output: 
  github_document:
    html_preview: true
    toc: true
params:
  summary: TRUE
  hnum: "H7.2"
  htitle: "Narcissism and use of self-related language"

title: "`r paste(params$hnum,'-',params$htitle)`"

---



```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(coefplot2)

```

```{r include=FALSE, ECHO=FALSE}
mentalizing<-read.csv("../data/SHARE/ROIs/mentalizing.csv")
ego_betweenness<-read.csv("../data/IndividualDifferenceMeasures/ego_betweeness_groups.csv")
df_combined_ment<-merge(mentalizing,ego_betweenness,by.x=c("Scan_ID"),by.y=c("pID"))
individual_differences<-read.csv("../data/IndividualDifferenceMeasures/DARPA1_Complete_Survey_Data_Scales_updated.csv")
df_combined_ment<-merge(individual_differences,df_combined_ment,by.x=c("pID"),by.y=c("Scan_ID"))
language<-read.csv("../data/SHARE/LanguageAnalysis/DARPA1_Language_In_Out_LIWC.csv")

reward<-read.csv("../data/SHARE/ROIs/kable_vmpfc_striatum.csv")

df_combined_reward<-merge(reward,ego_betweenness,by.x=c("Scan_ID"),by.y=c("pID"))


df_combined_reward<-merge(individual_differences,df_combined_reward,by.x=c("pID"),by.y=c("Scan_ID"))

language_id<-merge(language,individual_differences,by=c("pID"))
```



```{r, echo=FALSE}
md<-lm(r_i~nar,data=language_id)

ctable=coef(summary(md))
tval<-round(ctable[2,3],3)
df <- summary(md)$df[2]

stat_str <- paste0('t(',df,')=',tval)
```


```{asis eval=params$summary}

## Hypothesis

```


| `r ifelse(params$summary,'Hypothesis','') ` |  `r ifelse(params$summary,'Result','') ` |
| --------------------------------------------------- | --- |
| `r ifelse(params$summary,paste0('**',params$hnum,'**'),paste0('[**', params$hnum, "**](hypotheses/H5.1.md)'"))`: Those who score higher on narcissism will use more self-related language (first person singular) when writing Application reviews and Facebook messages in the Application Recommendation (Phase 3) and Sharing Tasks (Phase 2). | Not Significant  `r stat_str` |



```{r, results='asis', eval=params$summary, echo=FALSE}

library(pander)

pandoc.header("Results", level=2)
pandoc.header(paste('Model','-',params$htitle), level=3)

```


```{r, echo=FALSE, eval=params$summary}

md$call

round(coeftab(md, clevel=.95, sd=F, p.val=F),1)

coefplot2(md)
```


```{r, echo=FALSE, eval=params$summary}
summary(md)
```

